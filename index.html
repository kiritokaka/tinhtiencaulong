<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Tool T√≠nh Ti·ªÅn C·∫ßu L√¥ng</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin: 50px; }
    button { padding: 10px 20px; margin: 10px; font-size: 18px; }
    .output { font-size: 20px; margin-top: 20px; }
    .history { margin-top: 40px; text-align: left; max-width: 600px; margin-left: auto; margin-right: auto; }
    .history h2 { text-align: center; }
  </style>
</head>
<body>

  <h1>üí∞ Tool T√≠nh Ti·ªÅn C·∫ßu L√¥ng</h1>
  <p>S·ªë l∆∞·ª£ng ·ªëng c·∫ßu ƒë√£ b√°n:</p>

  <button onclick="changeAmount(-1)">‚ûñ</button>
  <span id="sold">0</span>
  <button onclick="changeAmount(1)">‚ûï</button>

  <div class="output">
    <p>üì¶ S·ªë h√†ng c√≤n l·∫°i: <strong id="remain">50</strong> ·ªëng</p>
    <p>üßÆ T·ªïng ti·ªÅn h√†ng t·ªìn: <strong id="inventory">0‚Ç´</strong></p>
    <p>üíµ Ti·ªÅn l√£i: <strong id="profit">0‚Ç´</strong></p>
  </div>

  <div class="history">
    <h2>üìú L·ªãch s·ª≠ giao d·ªãch</h2>
    <ul id="historyLog"></ul>
  </div>

  <script>
    const max = 50;
    const importPrice = 283200;
    const sellPrice = 295000;

    let sold = parseInt(localStorage.getItem('sold')) || 0;
    let history = JSON.parse(localStorage.getItem('history')) || [];

    function changeAmount(delta) {
      const newSold = sold + delta;
      if (newSold < 0 || newSold > max) return;

      sold = newSold;
      localStorage.setItem('sold', sold);

      const remain = max - sold;
      const inventoryValue = remain * importPrice;
      const profitValue = (sellPrice - importPrice) * sold;

      document.getElementById('sold').innerText = sold;
      document.getElementById('remain').innerText = remain;
      document.getElementById('inventory').innerText = formatVND(inventoryValue);
      document.getElementById('profit').innerText = formatVND(profitValue);

      // Ghi log n·∫øu delta != 0
      if (delta !== 0) {
        const entry = {
          time: new Date().toLocaleString('vi-VN'),
          action: delta > 0 ? `+${delta}` : `${delta}`,
          newSold: sold,
          remain,
          profit: profitValue
        };
        history.unshift(entry); // Th√™m ƒë·∫ßu danh s√°ch
        localStorage.setItem('history', JSON.stringify(history));
        renderHistory();
      }
    }

    function renderHistory() {
      const log = document.getElementById('historyLog');
      log.innerHTML = '';
      history.slice(0, 20).forEach(entry => {
        const li = document.createElement('li');
        li.textContent = `${entry.time} | B√°n ${entry.action} ·ªëng | C√≤n l·∫°i: ${entry.remain} | L√£i: ${formatVND(entry.profit)}`;
        log.appendChild(li);
      });
    }

    function formatVND(value) {
      return value.toLocaleString('vi-VN') + '‚Ç´';
    }

    // Kh·ªüi t·∫°o
    changeAmount(0);
    renderHistory();
  </script>

</body>
</html>